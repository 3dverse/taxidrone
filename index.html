<html>
    <head>
        <meta charset="UTF-8"/>
        <meta  content="width=device-width,initial-scale=1.0" name="viewport"/>
        <link rel="stylesheet" href="style1.css" />
    </head>
<body>
    

    <div class="canvas-container">
        <!-- CANVAS -->
        <canvas
            id="display-canvas"
            class="display-canvas"
            oncontextmenu="event.preventDefault()"
            onclick="onClick(event)"
        ></canvas>

        <div class="welcome-window" id="welcome-window">   
            <button class="bttn-go" role="button" id="bttn-goToConfig"> Start to Configure</button>
        </div>

        <div class="configuration-window" id="config-window"> 
            <!-- Config Aspa -->
            <div class="config-aspa">
                <button class="bttn-aspa-option" role="button" id="bttn-aspa-1">Aspa 1 sk1028</button>
                <button class="bttn-aspa-option" role="button" id="bttn-aspa-2">Aspa 2 sq302</button>
            </div>

            <!-- Config Mats -->
            <div class="config-mat">
                <button class="bttn-mat-option" role="button" id="bttn-material-1">Paint Red</button>
                <button class="bttn-mat-option" role="button" id="bttn-material-2">Paint Blue</button>
                <button class="bttn-mat-option" role="button" id="bttn-material-3">Paint White</button>
            </div>

             <!-- Config Anim-->
             <div class="config-anim">
                <button class="bttn-anim-option" role="button" id="bttn-anim-1">Light</button>
                <button class="bttn-anim-option" role="button" id="bttn-anim-2">Fly</button>
                <button class="bttn-anim-option" role="button" id="bttn-anim-3">360</button>
             </div>

            <!-- Go/back To -->
            <div class="flow-config">
                <button class="bttn-back" role="button" id="bttn-backToWelcome">Back</button>
                <button class="bttn-go" role="button" id="bttn-goToComparison">Go</button>  
            </div>
            

            <div class="config-label">
                <div id="label-hull" class="label">
                    <h4>este es el casco hecho de acero muy resistente</h4>
                </div>
                <div id="label-aspa-1" class="label">
                    <h4>estas son las aspas 1 sk1028</h4>
                </div>
                <div id="label-aspa-2" class="label">
                    <h4>estas son las aspas 2 sq302</h4>
                </div>
            </div>

        </div>


        <div class="comparative-window" id="comparative-window">
            <button class="bttn-comparative" role="button" id="bttn-comparative-1">Base Drone</button>
            <button class="bttn-comparative" role="button" id="bttn-comparative-2">Custom Drone</button>

            <button class="bttn-back" role="button" id="bttn-backToConfig">Back</button>
           
            
            <div class="annotations-comparative">

            </div>
        </div>

       


    </div>
        
    <!-- LIVELINK SDK -->
    <script src="https://cdn.3dverse.com/legacy/sdk/stable/SDK3DVerse.js"></script>

    
   
</body>
 <!-- APP ENTRYPOINT -->
 <script src="main.js" type="module"></script>

 <script>
    var isWelcome = true;
    var isConfiguration = false;
    var isComparison = false;

    var labels = ["label-hull", "label-aspa-1", "label-aspa-2"];

    //Flow  control of configurator windows
    document.getElementById("bttn-goToConfig").addEventListener('click', function(){
        isWelcome = false;
        isConfiguration = true;
        isComparison = false;

        HideAllAnotations(labels, "none");
    });
    document.getElementById("bttn-backToWelcome").addEventListener('click', function(){
        isWelcome = true;
        isConfiguration = false;
        isComparison = false;

        document.getElementById("label-hull").style.display = "none";
    });
    document.getElementById("bttn-goToComparison").addEventListener('click', function(){
        isWelcome = false;
        isConfiguration = false;
        isComparison = true;
        document.getElementById("label-hull").style.display = "none";
    });
    document.getElementById("bttn-backToConfig").addEventListener('click', function(){
        isWelcome = false;
        isConfiguration = true;
        isComparison = false;
        document.getElementById("label-hull").style.display = "none";
    });

  
    function HideAllAnotations(labelsArray, visualization){
        for(let i=0; i < labelsArray.length; i++){
            document.getElementById(labelsArray[i]).style.display = visualization;
        }
    }
    var lastEntity;
    //  get entities from click
    async function onClick(event){
        screenTarget = await SDK3DVerse.engineAPI.castScreenSpaceRay(event.clientX, event.clientY);

        if(!screenTarget.pickedPosition) return;

        const clickedEntity = screenTarget.entity;
       

        

        //console.log("clickee la entidad", clickedEntity.getEUID());
        
        if(isConfiguration){

             // mostrar una anotacion si se clickea una entidad especifica 
            if(clickedEntity.getEUID() ==  "de53715b-a4e5-4ff1-8533-1e50c530dda6"){
                document.getElementById(labels[0]).style.display = "inline";
                lastEntity = clickedEntity;
                clickedEntity.select();
            }
            else{
                document.getElementById(labels[0]).style.display = "none";
                lastEntity.unselect();
            }
        }
        
    }
   

    

    
 </script>


</html>