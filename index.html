<html>
    <head>
        <meta charset="UTF-8"/>
        <meta  content="width=device-width,initial-scale=1.0" name="viewport"/>
        <link rel="stylesheet" href="style.css" />
    </head>
<body>
    <div class="header-container">
        <div>
            <button class="bttn-flow" role="button" id="bttn-go-Welcome">Home</button>
        </div>
        <div>
            <hr>
        </div>
        <div>
            <button class="bttn-flow" role="button" id="bttn-go-Config">Configuration</button>
        </div>
        <div>
            <hr>
        </div>
        <div>
            <button class="bttn-flow" role="button" id="bttn-go-Comparison">Comparison</button>  
        </div>

    </div>

    
    <div class="canvas-container">
        <!-- CANVAS -->
        <canvas
            id="display-canvas"
            class="display-canvas"
            oncontextmenu="event.preventDefault()"
            onclick="onClick(event)"
        ></canvas>

        <!-- WELCOME UI -->
        <div class="welcome-window" id="welcome-window">
            <div class="welcome-title">
                <h2>X 7926R</h2>
                <h5>BY PREFIXA</h5>
            </div>
            <div class="welcome-text">
                <h6>Autonomous self-flying taxi drone X 7926R brings a business experience, an executive transportation aircraft, allowing to reach important meetings by skipping the expected traffic delays.
                </h6>
            </div>
        </div>
        <div class="start-button" id="start-button">
            <button class="bttn-start" role="button" id="bttn-start"> Press to start configuration</button>
        </div>

         <!-- Configuration UI -->
        <div class="configuration-window" id="config-window"> 
            <!-- Config sets -->
            <div class="config-sets">
                <div class="sets-bttns">
                    <div>
                        <button class="bttn-set" role="button" id="bttn-set-blade">Rotor blades</button>
                    </div>
                    <div>
                        <button class="bttn-set" role="button" id="bttn-set-mats">Exterior paint</button>
                    </div>
                    <div>
                        <button class="bttn-set" role="button" id="bttn-set-anim">Action</button>
                    </div>
                </div>
                  <!-- Config Aspa -->
                <div class="config-aspa">
                    <div>
                        <button class="bttn-aspa-option" role="button" id="bttn-aspa-1">Aspa 1 sk1028</button>
                    </div>
                    <div>
                        <button class="bttn-aspa-option" role="button" id="bttn-aspa-2">Aspa 2 sq302</button>
                    </div>
                </div>
                <!-- Config Mats -->
                <div class="config-mat">
                    <div>
                        <button class="bttn-mat-option" role="button" id="bttn-material-1">Paint Red</button>
                    </div>
                    <div>
                        <button class="bttn-mat-option" role="button" id="bttn-material-2">Paint Blue</button>
                    </div>
                    <div>
                         <button class="bttn-mat-option" role="button" id="bttn-material-3">Paint White</button>
                    </div>
                </div>
                  <!-- Config Anim-->
                <div class="config-anim">
                    <div>
                        <button class="bttn-anim-option" role="button" id="bttn-anim-2">Fly</button>
                    </div>
                    <div>
                       <button class="bttn-anim-option" role="button" id="bttn-anim-3">360</button>
                    </div>
                </div>

            </div>            

            <div class="config-set-lights">

                <div class="config-light">
                    <div>
                        <button class="bttn-light-toggle" role="button" id="bttn-anim-1">Light</button>
                    </div>
                </div>

            </div>

                     

            <div class="config-label">
                <div id="label-hull" class="label">
                    <h4>este es el casco hecho de acero muy resistente</h4>
                </div>
                <div id="label-aspa-1" class="label">
                    <h4>estas son las aspas 1 sk1028</h4>
                </div>
                <div id="label-aspa-2" class="label">
                    <h4>estas son las aspas 2 sq302</h4>
                </div>
            </div>

        </div>

        
        <!-- Comparative UI -->
        <div class="comparative-window" id="comparative-window">
            <button class="bttn-comparative" role="button" id="bttn-comparative-1">Base Drone</button>
            <button class="bttn-comparative" role="button" id="bttn-comparative-2">Custom Drone</button>
  
            <div class="annotations-comparative">

            </div>
        </div>

       


    </div>
        
    <!-- LIVELINK SDK -->
    <script src="https://cdn.3dverse.com/legacy/sdk/stable/SDK3DVerse.js"></script>

    
   
</body>
 <!-- APP ENTRYPOINT -->
 <script src="main2.js" type="module"></script>

 <script>
    var isWelcome = true;
    var isConfiguration = false;
    var isComparison = false;
    var id_hull = 'f8e609b9-e766-4e22-970c-6a15ff30aa85';

    //material selected
    var paint_select = 0;
    var id_select_mat = '7d1ce5eb-1d32-4040-978d-00b4108ca480';

    var labels = ["label-hull", "label-aspa-1", "label-aspa-2"];

    //Flow  control of configurator windows
    document.getElementById("bttn-go-Config").addEventListener('click', function(){
        isWelcome = false;
        isConfiguration = true;
        isComparison = false;

        paint_select = {value : id_select_mat};

        HideAllAnotations(labels, "none");
    });
    document.getElementById("bttn-start").addEventListener('click', function(){
        isWelcome = false;
        isConfiguration = true;
        isComparison = false;

        paint_select = {value : id_select_mat};

        HideAllAnotations(labels, "none");
    });
    document.getElementById("bttn-go-Welcome").addEventListener('click', function(){
        isWelcome = true;
        isConfiguration = false;
        isComparison = false;

        document.getElementById("label-hull").style.display = "none";
    });
    document.getElementById("bttn-go-Comparison").addEventListener('click', function(){
        isWelcome = false;
        isConfiguration = false;
        isComparison = true;
        document.getElementById("label-hull").style.display = "none";
    });
    

  
    function HideAllAnotations(labelsArray, visualization){
        for(let i=0; i < labelsArray.length; i++){
            document.getElementById(labelsArray[i]).style.display = visualization;
        }
    }
    var lastEntity;
    //  get entities from click
    async function onClick(event){
        screenTarget = await SDK3DVerse.engineAPI.castScreenSpaceRay(event.clientX, event.clientY);

        if(!screenTarget.pickedPosition) return;

        const clickedEntity = screenTarget.entity;
       
        
        

        console.log("clickee la entidad", clickedEntity.getEUID());
        
        if(isConfiguration){

             // mostrar una anotacion si se clickea una entidad especifica 
            if(clickedEntity.getEUID() ==  id_hull){
                document.getElementById(labels[0]).style.display = "inline";
                lastEntity = clickedEntity;
                //clickedEntity.select();
                //clickedEntity.setComponent('material_ref', paint_select);
            }
            else{
                document.getElementById(labels[0]).style.display = "none";
                lastEntity.unselect();
            }
        }
        
    }
   

    

    
 </script>


</html>